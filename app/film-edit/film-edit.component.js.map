{"version":3,"sources":["../../src/app/film-edit/film-edit.component.ts"],"names":[],"mappings":"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","file":"film-edit.component.js","sourcesContent":["import { Component, OnInit, OnDestroy } from '@angular/core';\r\nimport { ActivatedRoute, Router } from \"@angular/router\";\r\nimport { Subscription } from \"rxjs/Rx\";\r\n\r\nimport {\r\n  FormArray,\r\n  FormGroup,\r\n  FormControl,\r\n  Validators,\r\n  FormBuilder\r\n} from \"@angular/forms\";\r\n\r\nimport { FilmService }  from '../film.service';\r\nimport { Item } from '../item';\r\n\r\n@Component({\r\n  selector: 'film-edit',\r\n  templateUrl: './app/film-edit/film-edit.component.html'\r\n})\r\n\r\nexport class FilmEditComponent implements OnInit, OnDestroy {\r\n\tfilmForm: FormGroup;\r\n  private filmIndex: number;\r\n  private film: Item;\r\n  private isNew = true;\r\n  private subscription: Subscription;\r\n\r\n\r\n  constructor(private route: ActivatedRoute, private filmService: FilmService, private formBuilder: FormBuilder, private router: Router) {}\r\n\r\n  ngOnInit() {\r\n  \t this.subscription = this.route.params.subscribe(\r\n      (params: any) => {\r\n        if (params.hasOwnProperty('id')) {\r\n          this.isNew = false;\r\n          this.filmIndex = +params['id'];\r\n          this.film = this.filmService.getFilm(this.filmIndex);\r\n        } else {\r\n          this.isNew = true;\r\n          this.film = null;\r\n        }\r\n        this.initForm();\r\n      }\r\n    );\r\n  }\r\n\r\n  onSubmit() {\r\n    const newFilm = this.filmForm.value;\r\n    if (this.isNew) {\r\n      this.filmService.addFilm(newFilm);\r\n    } else {\r\n      this.filmService.editFilm(this.film, newFilm);\r\n    }\r\n    this.navigateBack();\r\n  }\r\n\r\n  onCancel() {\r\n    this.navigateBack();\r\n  }\r\n\r\n  onAddItem(name: string, amount: string) {\r\n    (<FormArray>this.filmForm.controls['movies']).push(\r\n      new FormGroup({\r\n        name: new FormControl(name, Validators.required),\r\n        amount: new FormControl(amount, [\r\n          Validators.required,\r\n          Validators.pattern(\"\\\\d+\")\r\n        ])\r\n      })\r\n    );\r\n  }\r\n\r\n  onRemoveItem(index: number) {\r\n    (<FormArray>this.filmForm.controls['movies']).removeAt(index);\r\n  }\r\n\r\nngOnDestroy() {\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  private navigateBack() {\r\n    this.router.navigate(['../']);\r\n  }\r\n\r\n  private initForm() {\r\n    let filmName = '';\r\n    let filmImageUrl = '';\r\n    let filmContent = '';\r\n    let filmMovies: FormArray = new FormArray([]);\r\n\r\n    if (!this.isNew) {\r\n      if (this.film.hasOwnProperty('movies')) {\r\n        for (let i = 0; i < this.film.movies.length; i++) {\r\n          filmMovies.push(\r\n            new FormGroup({\r\n              name: new FormControl(this.film.movies[i].name, Validators.required),\r\n              amount: new FormControl(this.film.movies[i].amount, [\r\n                Validators.required,\r\n                Validators.pattern(\"\\\\d+\")\r\n              ])\r\n            })\r\n          );\r\n        }\r\n      }\r\n      filmName = this.film.name;\r\n      filmImageUrl = this.film.imagePath;\r\n      filmContent = this.film.description;\r\n    }\r\n    this.filmForm = this.formBuilder.group({\r\n      name: [filmName, Validators.required],\r\n      imagePath: [filmImageUrl, Validators.required],\r\n      description: [filmContent, Validators.required],\r\n      movies: filmMovies\r\n    });\r\n  }\r\n\r\n\r\n}\r\n"],"sourceRoot":"/src"}